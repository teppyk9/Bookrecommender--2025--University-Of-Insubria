TRUNCATE TABLE LIBRERIA_LIBRO CASCADE;
TRUNCATE TABLE VALUTAZIONI CASCADE;
TRUNCATE TABLE CONSIGLI CASCADE;
TRUNCATE TABLE LIBRERIE CASCADE;


ALTER TABLE VALUTAZIONI RENAME COLUMN USERNAME TO ID_UTENTE;
ALTER TABLE VALUTAZIONI DROP CONSTRAINT IF EXISTS valutazioni_username_fkey;
ALTER TABLE VALUTAZIONI ALTER COLUMN ID_UTENTE TYPE INT USING ID_UTENTE::INT;
ALTER TABLE VALUTAZIONI
    ADD CONSTRAINT valutazioni_id_utente_fkey
        FOREIGN KEY (ID_UTENTE) REFERENCES UTENTI(ID);


ALTER TABLE CONSIGLI RENAME COLUMN USERNAME TO ID_UTENTE;
ALTER TABLE CONSIGLI DROP CONSTRAINT IF EXISTS consigli_username_fkey;
ALTER TABLE CONSIGLI ALTER COLUMN ID_UTENTE TYPE INT USING ID_UTENTE::INT;
ALTER TABLE CONSIGLI
    ADD CONSTRAINT consigli_id_utente_fkey
        FOREIGN KEY (ID_UTENTE) REFERENCES UTENTI(ID);



ALTER TABLE LIBRERIE RENAME COLUMN USERNAME TO ID_UTENTE;
ALTER TABLE LIBRERIE DROP CONSTRAINT IF EXISTS librerie_username_fkey;
ALTER TABLE LIBRERIE ALTER COLUMN ID_UTENTE TYPE INT USING ID_UTENTE::INT;
ALTER TABLE LIBRERIE
    ADD CONSTRAINT librerie_id_utente_fkey
        FOREIGN KEY (ID_UTENTE) REFERENCES UTENTI(ID);